"use strict";var _promises=_interopRequireDefault(require("dns/promises"));Object.defineProperty(exports,"__esModule",{value:!0}),exports.a=a,exports.aaaa=aaaa,exports.aaaaa=aaaaa,exports.ip=ip,exports.ips=ips;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}async function a(domain,timeout=2e3,server){let result={error:void 0,type:"dns/a",domain:domain,records:[]};return new Promise(resolve=>{let to=setTimeout(()=>{result.error="ETIMEDOUT",resolve(result)},timeout);"localhost"==domain.toLowerCase()?(result.records=["127.0.0.1"],resolve(result)):(_promises.default.setServers(server?[server]:["1.1.1.1","8.8.8.8","8.8.4.4"]),_promises.default.resolve4(domain).then(records=>{clearTimeout(to),result.records=records,resolve(result)}).catch(error=>{"ENODATA"!=error.code&&(result.error=error.code),resolve(result)}))})}async function aaaa(domain,timeout=2e3,server){let result={error:void 0,type:"dns/aaaa",domain:domain,records:[]};return new Promise(resolve=>{let to=setTimeout(()=>{result.error="ETIMEDOUT",resolve(result)},timeout);"localhost"==domain.toLowerCase()?resolve(result):(_promises.default.setServers(server?[server]:["1.1.1.1","8.8.8.8","8.8.4.4"]),_promises.default.resolve6(domain).then(records=>{clearTimeout(to),result.records=records,resolve(result)}).catch(error=>{"ENODATA"!=error.code&&(result.error=error.code),resolve(result)}))})}async function aaaaa(domain,server){let result={error:void 0,type:"dns/aaaaa",domain:domain,records:[]};const ipv4=await a(domain,2e3,server),ipv6=await aaaa(domain,2e3,server);return ipv4.error||ipv6.error?(result.error=ipv4.error||ipv6.error,result):(result.records=ipv4.records.concat(ipv6.records),result)}async function ip(host,server){if(!/((?:(?:(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9]))|(?:([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))(?=\s|$))/.test(host)){const res=await aaaaa(host,server);return 0>=res.records.length?null:res.records[0]}return host}async function ips(host,server){if(!/((?:(?:(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9]))|(?:([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))(?=\s|$))/.test(host)){const res=await aaaaa(host,server);return 0>=res.records.length?null:res.records}return[host]}